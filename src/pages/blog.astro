---
import MainLayout from "../layouts/MainLayout.astro";
import { getCollection } from "astro:content";
import SearchIsland from "../components/react/SearchIsland.jsx";

const allPosts = await getCollection("blog");
const publishedPosts = allPosts.filter((post) => !post.data.draft);

// Prepare posts with body content for search
const postsWithBody = publishedPosts.map((post) => ({
  slug: post.slug,
  data: post.data,
  body: post.body,
}));
---

<MainLayout title="المدونة" description="جميع المقالات المنشورة">
  <div class="container">
    <h1>المدونة</h1>
    <p class="subtitle">جميع المقالات المنشورة</p>

    <SearchIsland posts={postsWithBody} client:load />
  </div>
</MainLayout>

<style>
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }

  h1 {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
    color: var(--text-primary);
  }

  .subtitle {
    color: var(--text-secondary);
    margin-bottom: 2rem;
  }
</style>
