---
// Giscus Comments Component
// يجب تكوين Giscus على GitHub أولاً: https://giscus.app/
---

<div class="comments-section">
    <h2 class="comments-title">التعليقات</h2>
    <div class="giscus"></div>
</div>

<script>
    // تحميل Giscus script
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.setAttribute("data-repo", "YOUR_GITHUB_USERNAME/YOUR_REPO_NAME"); // يجب تعديله
    script.setAttribute("data-repo-id", "YOUR_REPO_ID"); // يجب تعديله
    script.setAttribute("data-category", "General");
    script.setAttribute("data-category-id", "YOUR_CATEGORY_ID"); // يجب تعديله
    script.setAttribute("data-mapping", "pathname");
    script.setAttribute("data-strict", "0");
    script.setAttribute("data-reactions-enabled", "1");
    script.setAttribute("data-emit-metadata", "0");
    script.setAttribute("data-input-position", "bottom");
    script.setAttribute("data-theme", "dark"); // يتناسب مع الثيم الداكن
    script.setAttribute("data-lang", "ar");
    script.setAttribute("crossorigin", "anonymous");
    script.async = true;

    // إضافة السكريبت إلى الصفحة
    const giscusContainer = document.querySelector(".giscus");
    if (giscusContainer) {
        giscusContainer.appendChild(script);
    }

    // تبديل ثيم Giscus عند تغيير ثيم الموقع
    const observer = new MutationObserver(() => {
        const theme = document.documentElement.getAttribute("data-theme");
        const iframe = document.querySelector("iframe.giscus-frame");
        if (iframe) {
            iframe.contentWindow?.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme === "dark" ? "dark" : "light",
                        },
                    },
                },
                "https://giscus.app",
            );
        }
    });

    observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ["data-theme"],
    });
</script>

<style>
    .comments-section {
        max-width: 800px;
        margin: 3rem auto 0;
        padding-top: 2rem;
        border-top: 1px solid var(--color-border);
    }

    .comments-title {
        font-size: 1.5rem;
        margin-bottom: 1.5rem;
        color: var(--color-text);
    }

    .giscus {
        min-height: 200px;
    }
</style>
